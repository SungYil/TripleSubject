CREATE TABLE user(
	ID BIGINT NOT NULL AUTO_INCREMENT,
	ACHIEVE_POINT INT,
	UUID VARCHAR(255) UNIQUE,
	PRIMARY KEY(ID)
)ENGINE=INNODB;

CREATE TABLE place(
	ID BIGINT NOT NULL AUTO_INCREMENT,
	UUID VARCHAR(255),
	PRIMARY KEY(ID)
)ENGINE=INNODB;

CREATE TABLE review(
	ID BIGINT NOT NULL AUTO_INCREMENT,
	CONTENT VARCHAR(255) DEFAULT NULL,
	STATE INT DEFAULT NULL,
	UUID VARCHAR(255) DEFAULT NULL,
	CREATOR_ID BIGINT DEFAULT NULL,
	PLACE_ID BIGINT DEFAULT NULL,
    ACCESS_COUNT BIGINT,
	PRIMARY KEY(ID),
    UNIQUE ACCESS_COUNT_UUID (UUID,ACCESS_COUNT,STATE),
	FOREIGN KEY(PLACE_ID) REFERENCES PLACE (ID),
	FOREIGN KEY(CREATOR_ID) REFERENCES USER (ID)
)ENGINE=INNODB;

CREATE INDEX idx_creator_place on review (creator_id,place_id);

CREATE TABLE image(
	ID BIGINT NOT NULL AUTO_INCREMENT,
	UUID VARCHAR(255) DEFAULT NULL,
	REVIEW_ID BIGINT DEFAULT NULL,
	PRIMARY KEY(ID),
	FOREIGN KEY(REVIEW_ID) REFERENCES REVIEW (ID)
)ENGINE=INNODB;

CREATE TABLE event(
	ID BIGINT NOT NULL AUTO_INCREMENT,
	EVENT JSON DEFAULT NULL,
	POINT_DELTA INT DEFAULT NULL,
	PLACE_ID BIGINT DEFAULT NULL,
	REVIEW_ID BIGINT DEFAULT NULL,
	USER_ID BIGINT DEFAULT NULL,
	PRIMARY KEY(ID),
	FOREIGN KEY (USER_ID) REFERENCES USER (ID),
	FOREIGN KEY (REVIEW_ID) REFERENCES REVIEW (ID),
	FOREIGN KEY (PLACE_ID) REFERENCES PLACE (ID)
)ENGINE=INNODB;